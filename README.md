Refactored code for https://proceedings.mlr.press/v151/dellaporta22a/dellaporta22a.pdf by 
Charita Dellaporta, Jeremias Knoblauch, Theodoros Damoulas and Fran√ßois-Xavier Briol.


